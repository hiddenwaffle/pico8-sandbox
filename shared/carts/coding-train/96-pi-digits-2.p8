pico-8 cartridge // http://www.pico-8.com
version 18
__lua__

-- coding challenge #96
-- https://www.youtube.com/watch?v=WEd_UIKG-uc

#include lib/math.p8:0

-- from https://www.piday.org/million/
digits =           '314159265358979323846264338327950288419716939937510582097494459230781640628620899862'
digits = digits .. '803482534211706798214808651328230664709384460955058223172535940812848111745028410270'
digits = digits .. '193852110555964462294895493038196442881097566593344612847564823378678316527120190914'
digits = digits .. '564856692346034861045432664821339360726024914127372458700660631558817488152092096282'
digits = digits .. '925409171536436789259036001133053054882046652138414695194151160943305727036575959195'
digits = digits .. '309218611738193261179310511854807446237996274956735188575272489122793818301194912983'
digits = digits .. '367336244065664308602139494639522473719070217986094370277053921717629317675238467481'
digits = digits .. '846766940513200056812714526356082778577134275778960917363717872146844090122495343014'
digits = digits .. '654958537105079227968925892354201995611212902196086403441815981362977477130996051870'
digits = digits .. '721134999999837297804995105973173281609631859502445945534690830264252230825334468503'
digits = digits .. '526193118817101000313783875288658753320838142061717766914730359825349042875546873115'
digits = digits .. '956286388235378759375195778185778053217122680661300192787661119590921642019893809525'
digits = digits .. '720106548586327886593615338182796823030195203530185296899577362259941389124972177528'
digits = digits .. '347913151557485724245415069595082953311686172785588907509838175463746493931925506040'
digits = digits .. '092770167113900984882401285836160356370766010471018194295559619894676783744944825537'
digits = digits .. '977472684710404753464620804668425906949129331367702898915210475216205696602405803815'
digits = digits .. '019351125338243003558764024749647326391419927260426992279678235478163600934172164121'
digits = digits .. '992458631503028618297455570674983850549458858692699569092721079750930295532116534498'
digits = digits .. '720275596023648066549911988183479775356636980742654252786255181841757467289097777279'
digits = digits .. '380008164706001614524919217321721477235014144197356854816136115735255213347574184946'
digits = digits .. '843852332390739414333454776241686251898356948556209921922218427255025425688767179049'
digits = digits .. '460165346680498862723279178608578438382796797668145410095388378636095068006422512520'
digits = digits .. '511739298489608412848862694560424196528502221066118630674427862203919494504712371378'
digits = digits .. '696095636437191728746776465757396241389086583264599581339047802759009946576407895126'
digits = digits .. '946839835259570982582262052248940772671947826848260147699090264013639443745530506820'
digits = digits .. '349625245174939965143142980919065925093722169646151570985838741059788595977297549893'

local index = 1
local speed = 0.3
local r = 60
local color = 0

function _init()
  cls(1)
  camera(-64, -64)
  circ(0, 0, r, 11)
end

function _update60()
end

function _draw()
  local digit = tonum(sub(digits, index, index))
  if (not digit) return -- end of the digits table
  local next_digit = tonum(sub(digits, index + 1, index + 1))
  if (not next_digit) return -- end of the digits table
  index += 1

  local diff = (1 / 10) * 0.01 -- a little bit of imprecision

  local a1 = math_map(digit, 0, 10, 0, 1) + rnd(diff * 2 - diff)
  local a2 = math_map(next_digit, 0, 10, 0, 1) + rnd(diff * 2 - diff)
  local x1 = r * cos(a1)
  local y1 = r * sin(a1)
  local x2 = r * cos(a2)
  local y2 = r * sin(a2)
  line(x1, y1, x2, y2, color)
  color += 1
  if (color == 1) color = 2
end
